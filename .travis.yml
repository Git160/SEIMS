# This is the config file for building SEIMS with Travis-ci.org
branches:
  only:
  - master
matrix:
  fast_finish: true
  include:
    - os: osx
      language: cpp
      compiler: clang
      sudo: required
      cache:
        apt: true
        directories:
          - $HOME/.ccache
      env:
        - BUILD_NAME=osx_xcode
        - DETAILS="debug build, libtool"
        - ENABLE_CXX11=1
    - os: linux
      dist: trusty
      compiler: gcc
      language: cpp
      sudo: required
      cache:
        apt: true
        directories:
          - $HOME/.ccache
      services:
        - mongodb
      env:
        - BUILD_NAME=linux_gcc48
        - DETAILS=""
        - ENABLE_CXX11=1
before_install:
  - ./doc/ci/travis/${BUILD_NAME}/before_install.sh

install:
  - ./doc/ci/travis/${BUILD_NAME}/install.sh

script:
  - ./doc/ci/travis/${BUILD_NAME}/script.sh
  # push automatically generated doxygen html files to gh-pages branch, only once
  - 'if [ ${BUILD_NAME} = "linux_gcc48" ]; then
      openssl aes-256-cbc -K $encrypted_9c89c5b645f3_key -iv $encrypted_9c89c5b645f3_iv
        -in doc/doxygen/travisci_rsa.enc -out doc/doxygen/travisci_rsa -d;
      chmod 0600 doc/doxygen/travisci_rsa;
      cp doc/doxygen/travisci_rsa ~/.ssh/id_rsa;
      chmod 700 doc/doxygen/publish-doxygen;
      "./doc/doxygen/publish-doxygen";
    fi'

notifications:
  email:false